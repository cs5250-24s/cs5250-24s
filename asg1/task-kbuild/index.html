
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../task-vm/">
      
      
        <link rel="next" href="../task-boot/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Task 2: Build and Install Linux Kernel - CS5250 Assignments (2024 Spring)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task-2-build-and-install-linux-kernel" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CS5250 Assignments (2024 Spring)" class="md-header__button md-logo" aria-label="CS5250 Assignments (2024 Spring)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CS5250 Assignments (2024 Spring)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task 2: Build and Install Linux Kernel
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Assignment 1

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../asg2/" class="md-tabs__link">
          
  
    
  
  Assignment 2

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../asg3/" class="md-tabs__link">
          
  
    
  
  Assignment 3

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../asg4/" class="md-tabs__link">
          
  
    
  
  Assignment 4

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CS5250 Assignments (2024 Spring)" class="md-nav__button md-logo" aria-label="CS5250 Assignments (2024 Spring)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CS5250 Assignments (2024 Spring)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Assignment 1
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Assignment 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../task-vm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 1: Setup a Virtual Machine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Task 2: Build and Install Linux Kernel
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Task 2: Build and Install Linux Kernel
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kernel-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Source Code
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kernel Source Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloning-the-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Cloning the Tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downloading-kernel-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading Kernel Source Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-version" class="md-nav__link">
    <span class="md-ellipsis">
      Check the Version
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernel-building" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Building
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-linux-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      Install Linux Kernel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-grub" class="md-nav__link">
    <span class="md-ellipsis">
      Configure GRUB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customize-the-kernel-build" class="md-nav__link">
    <span class="md-ellipsis">
      Customize the Kernel Build
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customize the Kernel Build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#menuconfig" class="md-nav__link">
    <span class="md-ellipsis">
      menuconfig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shrink-the-kernel-image" class="md-nav__link">
    <span class="md-ellipsis">
      Shrink the Kernel Image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../task-boot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 3: Experience the Boot Sequence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../asg2/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Assignment 2
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Assignment 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 1: Developing a Kernel Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-syscall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 2: Creating a New System Call
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-gdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 3: Debugging with GDB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../asg3/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Assignment 3
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assignment 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg3/task-kprobe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 1: Hook System Calls with KProbes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg3/task-memhack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 2: Memory Manipulation in Tetris Game
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg3/task-sched/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optional: Understanding the Linux Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../asg4/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Assignment 4
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Assignment 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-cloudinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 0: Cloud-Init
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-chardev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 1: Character Device Driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-pcidev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 2: PCI Device
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-interrupt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 3: Interrupt handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="task-2-build-and-install-linux-kernel">Task 2: Build and Install Linux Kernel</h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are using the course-provided server, kindly perform this task within your VM.
<strong>At no point should you attempt to install the kernel built by yourself directly in the server.</strong></p>
</div>
<h2 id="kernel-source-code">Kernel Source Code</h2>
<p>To access the Linux kernel releases, visit the official website at <a href="https://www.kernel.org">https://www.kernel.org</a>.
These releases fall into several main categories: mainline, stable, and long-term.
For more information on the different categories, please check
<a href="https://www.kernel.org/category/releases.html">this page</a>.</p>
<p>In this course, we will work with the latest stable release when the course begins, which is Linux 6.7.
You can find the repository for the mainline tree at
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git</a>
and the repository for the stable tree at
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git">https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git</a>.</p>
<p>To obtain a local copy of the code, we have two options:</p>
<ol>
<li>Download a release.</li>
<li>Clone the repository.</li>
</ol>
<p>You can choose the method that best suits your needs, as different tasks may require different approaches.</p>
<h3 id="cloning-the-tree">Cloning the Tree</h3>
<p>To work with Linux kernel sources and perform tasks such as generating a patch, you'll need to clone the git tree.
Use the following command to clone the repository:</p>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git<span class="w"> </span>--depth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--branch<span class="w"> </span>v6.7
</code></pre></div>
<p>Here's what each option does:</p>
<ul>
<li>
<p><code>--depth 1</code>:</p>
<p>Creates a shallow clone with the history truncated to only one commit, reducing the size of downloaded git objects.</p>
</li>
</ul>
<ul>
<li>
<p><code>--branch xxx</code>:</p>
<p>Specifies the branch (or tag) to clone.</p>
</li>
</ul>
<h3 id="downloading-kernel-source-code">Downloading Kernel Source Code</h3>
<p>To download a kernel source code release, visit this link: <a href="https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.7.tar.xz">https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.7.tar.xz</a>.</p>
<p>All kernel releases are cryptographically signed.
To ensure the integrity of your downloaded kernel releases, follow the instructions provided <a href="https://www.kernel.org/category/signatures.html">here</a>.</p>
<h3 id="check-the-version">Check the Version</h3>
<p>Execute the following command to check which version you currently have:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>make kernelversion
</code></pre></div>
<p>If you obtained the kernel source code by cloning the repository, you may also check the commit history:</p>
<div class="language-console highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="go">git log -1</span>
</code></pre></div>
<h2 id="kernel-building">Kernel Building</h2>
<div class="admonition info">
<p class="admonition-title">Additional dependencies</p>
<p>In this part, you may encounter errors like:</p>
<ul>
<li>Command not found: <code>xxx</code></li>
<li>Unable to find <code>xxx</code> package</li>
<li>...</li>
</ul>
<p>This indicates that specific programs, libraries, or headers are missing on your machine.
You'll need to install the necessary dependencies.
Typically, this involves installing Ubuntu software packages required for kernel building.
As you continue, you'll become more comfortable with this process.</p>
</div>
<ol>
<li>
<p><strong><code>make defconfig</code></strong></p>
<p>This will create a default configuration file for the kernel.</p>
</li>
<li>
<p><strong><code>make -j$(nproc)</code></strong></p>
<p>Compiling the kernel is a time-consuming task, and it may take a while.
 While you wait, you can think about ways to optimize the process for future builds.
 Patience is key during this step.</p>
</li>
</ol>
<h2 id="install-linux-kernel">Install Linux Kernel</h2>
<ol>
<li>
<p><strong><code>make modules_install</code></strong></p>
<p>This command is used to install kernel modules.</p>
</li>
<li>
<p><strong><code>make install</code></strong></p>
<p>This command is responsible for installing the newly built kernel.
 It's the final step in getting your custom kernel ready for use.
 Please try to find out which directory the kernel image is installed to.</p>
</li>
</ol>
<h2 id="configure-grub">Configure GRUB</h2>
<p>The kernel image is now in the correct location.
However, the bootloader might not be aware of it yet.</p>
<p>The boot order of the operating systems is specified in <code>/boot/grub/grub.cfg</code>.
By updating this file, you can modify the default OS, the sequence of different kernel releases, and the behaviour of the GRUB menu.</p>
<p>Try to figure out how to update this file (or how the file is updated).
The original settings in related files and some online research will be very helpful.
Please note that root privileges are required for this step.</p>
<p>If this is your first time performing this operation, it is recommended to create a backup or snapshot before proceeding.</p>
<p>After rebooting, check whether the boot option appears as expected.
(Additional configuration may be necessary to make the GRUB menu appear on boot.)</p>
<p><img alt="GRUB Menu" src="../grub-menu.png" /></p>
<p>If everything goes well, you should see the login prompt.
After logging in, some messages (motd) will be printed out.
The kernel release version, which should have changed to the new one, is reflected in the first line.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>It is expected that the new kernel will start up without any problems.
If something does go wrong, check the error messages and try to figure out what caused the issue.
You may ask your friends or the TA for help if you get stuck at this step.</p>
</div>
<h2 id="customize-the-kernel-build">Customize the Kernel Build</h2>
<p>In this task, you will build a smaller kernel image that will successfully boot up on your virtual machine.
You can do so by customizing the kernel configuration and removing unnecessary features.</p>
<h3 id="menuconfig">menuconfig</h3>
<p>To customize the kernel configuration, you may use the <code>menuconfig</code> tool.</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>make menuconfig
</code></pre></div>
<p>This command will open a menu that allows you to customize the kernel configuration.
<img alt="menuconfig" src="../menuconfig.png" /></p>
<p>You will typically encounter three options for most features: <code>built-in</code>, <code>excluded</code>, and <code>module</code>.
What do these choices mean, and which one(s) cause the related functions to be included in the kernel image?</p>
<p>Feel free to explore other ways to update the config.
You may start from checking the information from <code>make help</code>.</p>
<h3 id="shrink-the-kernel-image">Shrink the Kernel Image</h3>
<p>Please try to shrink the kernel image by removing unnecessary features.
Please note:</p>
<ul>
<li>Keep the original kernel for comparison.</li>
<li>Give your smaller kernel a different name from the one built in the previous task.
  You can customize the kernel release version by updating <code>LOCALVERSION</code> in the kernel config to identify your kernel images.
  Use the search function of <code>menuconfig</code> to find where to modify the option.</li>
<li>Your goal is to reduce the size of the kernel image (<code>./arch/x86/boot/bzImage</code>) to less than 8 MiB.
  There's no need to shrink it excessively.</li>
<li>To ensure that the VM has successfully booted up, verify that the VM reaches the same login screen as your original kernel.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>When you attempt to boot with your new kernel after removing certain features, expect something strange to happen.
It's a good idea to document the changes you made to the kernel configuration.
This record will be handy in figuring out the cause of any issues that arise.
This part of the assignment is designed to prompt you to observe the effects of disabling specific features, understand their importance, and then work on fixing any resulting problems.</p>
</div>
<p>For your submission, build your customized kernel into a DEB package using the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>make bindeb-pkg
</code></pre></div>
<p>You may need additional dependencies to build the DEB package successfully.
After doing so, several new files should be generated in the parent folder (not the current directory).
Submit the file whose name starts with <code>linux-image</code>.
You can check the file using the commands below:</p>
<ol>
<li><code>dpkg -c linux-image-6.7..._amd64.deb</code>
   This command lists the contents of the DEB package.
   Inside the package, there should be a file named <code>./boot/vmlinuz-6.7...</code>.
   If not, you might be looking at the wrong file.</li>
<li>
<p><code>dpkg -f linux-image-6.7..._amd64.deb Maintainer</code>
   This command extracts the <code>Maintainer</code> information from the control file in the DEB package.
   The output should be like:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>user &lt;user@hostname&gt;
</code></pre></div>
<p>Please note: <code>user</code> should not be <code>root</code> and <code>hostname</code> should start with your NUSNET ID.</p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.indexes", "navigation.sections", "navigation.tabs", "toc.integrate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="../../javascripts/open_in_new_tab.js"></script>
      
    
  </body>
</html>